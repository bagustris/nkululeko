; exp_multi_testsets_neutral_angry.ini
; Demonstrates the multiple test sets feature (per-dataset result reporting).
;
; Setup:
;   Training : E-SERAVD (Indonesian SER corpus -- all three CSV splits used as train)
;   Test set 1: Polish   (polish_test.csv only)
;   Test set 2: KBES     (kbes_test.csv only)
;
; Only the two emotions that all three datasets share are used:
;   - "angry"  (E-SERAVD and KBES label)
;   - "anger"  (Polish label, mapped to "angry" for consistency)
;   - "neutral" (shared by all three)
;
; After training the model is automatically evaluated on the combined test set
; *and* separately on each test dataset, producing individual confusion matrices
; and UAR scores per dataset (courtesy of Experiment.evaluate_per_test_set()).
;
; Prerequisites â€“ generate the CSV files for the datasets that need it:
;   cd data/e-seravd && python3 process_database.py && cd ../..
;   cd data/kbes     && python3 process_database.py && cd ../..
;   (Polish CSVs are already included in the repository.)
;
; Run:
;   python -m nkululeko.nkululeko --config examples/exp_multi_testsets_neutral_angry.ini

[EXP]
root = ./examples/results/
name = exp_multi_testsets_neutral_angry
runs = 1
epochs = 1
save = True

[DATA]
; All five entries are loaded; the e-seravd splits feed the training set and
; polish/kbes feed the two independent test sets.
databases = ['eseravd_train', 'eseravd_dev', 'eseravd_test', 'polish', 'kbes']

; ---  E-SERAVD (Indonesian, 4 emotions: angry/sad/neutral/happy)  -----------
; All three CSV splits are used as training data so the model benefits from the
; full dataset.  Samples outside {angry, neutral} are filtered out.
eseravd_train = ./data/e-seravd/e-seravd_train.csv
eseravd_train.type = csv
eseravd_train.absolute_path = False
eseravd_train.audio_path = E-SERAVD/
eseravd_train.split_strategy = train
eseravd_train.filter = {'emotion': ['angry', 'neutral']}

eseravd_dev = ./data/e-seravd/e-seravd_dev.csv
eseravd_dev.type = csv
eseravd_dev.absolute_path = False
eseravd_dev.audio_path = E-SERAVD/
eseravd_dev.split_strategy = train
eseravd_dev.filter = {'emotion': ['angry', 'neutral']}

eseravd_test = ./data/e-seravd/e-seravd_test.csv
eseravd_test.type = csv
eseravd_test.absolute_path = False
eseravd_test.audio_path = E-SERAVD/
eseravd_test.split_strategy = train
eseravd_test.filter = {'emotion': ['angry', 'neutral']}

; ---  Polish (3 emotions: anger/neutral/fear)  --------------------------------
; Filtered to anger+neutral, then "anger" is mapped to "angry" so the label
; space matches E-SERAVD and KBES.  The filter is applied before the mapping,
; so the raw Polish label "anger" must be used in the filter expression.
polish = ./data/polish/polish_test.csv
polish.type = csv
polish.absolute_path = False
polish.split_strategy = test
polish.filter = {'emotion': ['anger', 'neutral']}
polish.mapping = {'anger': 'angry'}

; ---  KBES -- KUET Bangla Emotional Speech (4 emotions: angry/neutral/sad/happy)
kbes = ./data/kbes/kbes_test.csv
kbes.type = csv
kbes.absolute_path = False
kbes.split_strategy = test
kbes.filter = {'emotion': ['angry', 'neutral']}

; Unified label space after filtering and mapping
target = emotion
labels = ['angry', 'neutral']

[FEATS]
type = ['os']
scale = standard

[MODEL]
type = xgb

[RESAMPLE]
; Resample all audio to 16 kHz if needed
replace = True
